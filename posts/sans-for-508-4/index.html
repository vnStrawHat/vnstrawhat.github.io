<!DOCTYPE html>
<html lang="en" >
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.55.6" />
        
        <link rel="canonical" href="https://vnstrawhat.github.io/posts/sans-for-508-4/" />
        <meta name="description" content="">
        
        <title>FOR 508: Intelligence-Driven Incident Response &middot; TrungKFC</title>
        <link rel="shortcut icon" href="https://vnstrawhat.github.io/images/favicon.ico" />
        <link rel="stylesheet" href="https://vnstrawhat.github.io/css/main.css" />
        
        
                <link rel="stylesheet"
                    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/an-old-hope.min.css">
                    
                    
                    
                    
                    <link rel="stylesheet" href="https://vnstrawhat.github.io/css/kfc.css">
                    
                </head>

<body class="loading dark-mode">
    
<div class="top">
    <img class="logo" src="https://vnstrawhat.github.io/images/logo.svg" alt="logo" />
</div>
<div class="bottom">
    <img class="logo" src="https://vnstrawhat.github.io/images/logo.svg" alt="logo" />
</div>

    <header class="header">
    <ul class="menu clearfix control">
        

<li class="logo-container logo-default">
    <a href="https://vnstrawhat.github.io" class="btn logo-link">
        <img class="logo" src="https://vnstrawhat.github.io/images/logo.svg" alt="logo" />
    </a>
</li>

        
        
        
        
        <li 
            class="">
            <a class="btn" id="theme-switcher-button">
                Article
            </a>
            <ul class="sub-menu control">
                
                <li class="">
                    <a href="/posts"
                    
                        class="btn "
                    >Posts</a>
                </li>
                
                <li class="">
                    <a href="/tags"
                    
                        class="btn "
                    >Tags</a>
                </li>
                
                <li class="">
                    <a href="/categories"
                    
                        class="btn "
                    >Categories</a>
                </li>
                
            </ul>
        </li>
        
        
        
        
        <li 
            class="">
            <a class="btn" id="theme-switcher-button">
                View
            </a>
            <ul class="sub-menu control">
                
                <li class="">
                    <a href="#"
                    
                        class="btn toggle-sidebar"
                    >Toggle Sidebar</a>
                </li>
                
            </ul>
        </li>
        
        
        
        <li>
            <a href="/" class="btn">
                About
            </a>
        </li>
        
        
    </ul>
</header>

    <div class="middle">
        <nav class="sidebar">
            <ul class="control">
    
    <br>
    <li class="taxonomy-key">Categories</li>
    
    
    <li>
        <a href="https://vnstrawhat.github.io/categories/hack-the-box" class="btn">
            <i class="icon icon-categories"></i>
            hack-the-box
            <span class="count">1</span>
        </a>
    </li>
    
    
    
    <li>
        <a href="https://vnstrawhat.github.io/categories/sans-for508" class="btn">
            <i class="icon icon-categories"></i>
            sans-for508
            <span class="count">5</span>
        </a>
    </li>
    
    
    
    <br>
    <li class="taxonomy-key">Tags</li>
    
    
    <li>
        <a href="https://vnstrawhat.github.io/tags/incident-response" class="btn">
            <i class="icon icon-tags"></i>
            incident-response
            <span class="count">10</span>
        </a>
    </li>
    
    
    
    <li>
        <a href="https://vnstrawhat.github.io/tags/mcafee" class="btn">
            <i class="icon icon-tags"></i>
            mcafee
            <span class="count">1</span>
        </a>
    </li>
    
    
    
    <li>
        <a href="https://vnstrawhat.github.io/tags/reverse-shell" class="btn">
            <i class="icon icon-tags"></i>
            reverse-shell
            <span class="count">1</span>
        </a>
    </li>
    
    
    
    <li>
        <a href="https://vnstrawhat.github.io/tags/sans-for508" class="btn">
            <i class="icon icon-tags"></i>
            sans-for508
            <span class="count">5</span>
        </a>
    </li>
    
    
    
    <br>
    <li class="taxonomy-key">Recent Posts</li>
    
    <li><a class="no-break btn" href='/posts/sans-for-508-4/'><i class="icon icon-post"></i>FOR 508: Intelligence-Driven Incident Response</a></li>
    
    <li><a class="no-break btn" href='/posts/some-work-with-mcafee-endpoint-security/'><i class="icon icon-post"></i>Some work With Mcafee Endpoint Security</a></li>
    
    <li><a class="no-break btn" href='/posts/sans-for-508-3/'><i class="icon icon-post"></i>FOR 508: Hunting versus Reactive Response</a></li>
    
    <li><a class="no-break btn" href='/posts/sans-for-508-2/'><i class="icon icon-post"></i>FOR 508: Active Defence</a></li>
    
    <li><a class="no-break btn" href='/posts/sans-for-508-1/'><i class="icon icon-post"></i>FOR 508: The problem ?</a></li>
    
    <li><a class="no-break btn" href='/posts/sans-for-508/'><i class="icon icon-post"></i>FOR 508: Six-Step Incident Response Process</a></li>
    
    <li><a class="no-break btn" href='/posts/reverse_shell_all_the_think/'><i class="icon icon-post"></i>Reverse Shell</a></li>
    
    <li><a class="no-break btn" href='/posts/security_incident_response_part4/'><i class="icon icon-post"></i>IR part 4 - Quy tr√¨nh ·ª©ng ph√≥ s·ª± c·ªë</a></li>
    
    <li><a class="no-break btn" href='/posts/security_incident_response_part3/'><i class="icon icon-post"></i>IR part 3 - C∆° c·∫•u c·ªßa m·ªôt ƒë·ªôi ·ª©ng ph√≥ s·ª± c·ªë</a></li>
    
    <li><a class="no-break btn" href='/posts/security_incident_response_part2/'><i class="icon icon-post"></i>IR part 2 - Ch√≠nh s√°ch, k·∫ø ho·∫°ch, th·ªß t·ª•c ·ª©ng ph√≥ s·ª± c·ªë</a></li>
    
</ul>
        </nav>
        <main class="main">
            <article class="article">
    <h3 class="title"><a href='/posts/sans-for-508-4/' class="btn">FOR 508: Intelligence-Driven Incident Response</a></h3>
    <div class="article-meta clearfix">
        <ul class="dates clearfix left control">
            <li><i class="icon icon-date"></i></li>
            <li class="publish-date">
                <time datetime="2019.07.19">2019.07.19</time>
            </li>
        </ul>
        
        <ul class="article-categories clearfix left control">
            <li><i class="icon icon-categories"></i></li>
            
            <li>
                <a href="https://vnstrawhat.github.io/categories/sans-for508/" class="btn">SANS FOR508</a>
            </li>
            
        </ul>
        
        
        <div class="article-meta-splitter clearfix"></div>
        <ul class="article-tags clearfix control">
            <li><i class="icon icon-tags"></i></li>
            
            <li>
                <a href="https://vnstrawhat.github.io/tags/incident-response/" class="btn">Incident Response</a>
            </li>
            
            <li>
                <a href="https://vnstrawhat.github.io/tags/sans-for508/" class="btn">SANS FOR508</a>
            </li>
            
        </ul>
        
    </div>
    <div class="content">
        
        

<h1 id="intelligence-driven-incident-response">Intelligence-Driven Incident Response</h1>

<p><center><img src="/images/intelligence_driven_ir.PNG" alt="Hunting vs Reactive Response" /></center></p>

<p>H√¨nh tr√™n th·ªÉ hi·ªán b∆∞·ªõc identification/scoping v√† ∆∞·ªõc containment/intelligence development s·∫Ω ƒë∆∞·ª£c l·∫∑p ƒëi l·∫∑p l·∫°i trong qu√° tr√¨nh s·ª± c·ªë ƒëang x·∫£y ra ho·∫∑c ƒë√£ x·∫£y ra. ƒêa s·ªë Hunting Team s·∫Ω li√™n t·ª•c s·ª≠ d·ª•ng c√°c feedback t·ª´ v√≤ng l·∫∑p tr√™n ƒë·ªÉ gi√∫p cho vi·ªác x√°c ƒë·ªãnh c√°c h·ªá th·ªëng b·ªã chi·∫øm quy·ªÅn ƒëi·ªÅu khi·ªÉn m·ªôt c√°ch nhanh nh·∫•t. C√≥ kh·∫£ nƒÉng k·∫ª t·∫•n c√¥ng s·∫Ω c·ªë g·∫Øng x√¢m nh·∫≠p l·∫°i h·ªá th·ªëng c·ªßa b·∫°n m·ªôt l·∫ßn n·ªØa v√† Team Incident Response b√¢y gi·ªù ƒë√£ ƒë∆∞·ª£c trang b·ªã c√°c ki·∫øn th·ª©c ph√π h·ª£p s·∫Ω h√†nh ƒë·ªông nhanh h∆°n, ch·ªß ƒë·ªông h∆°n trong vi·ªác t√¨m ki·∫øm, theo d√µi c√°c v·ªã tr√≠ m√† k·∫ª t·∫•n c√¥ng c√≥ kh·∫£ nƒÉng xu·∫•t hi·ªán. B·∫±ng c√°ch s·ª≠ d·ª•ng k·∫øt h·ª£p gi·ªØa manual v√† automation, vi·ªác c·ªßa Team Incident Response l√† t√¨m ki·∫øm, x√°c ƒë·ªãnh c√°c TTP (Tactics, Techniques and Procedures) c·ªßa k·∫ª t·∫•n c√¥ng tr√™n c√°c h·ªá th·ªëng.</p>

<p>C√°c lo·∫°i TTPs s·∫Ω r·∫•t h·ªØu d·ª•ng ƒë·ªëi v·ªõi Hunting Team cho vi·ªác x√°c ƒë·ªãnh m·ª•c ti√™u c·ªßa k·∫ª t·∫•n c√¥ng ƒëang mu·ªën th·ª±c hi·ªán. C√°c lo·∫°i TTPs c√≥ th·ªÉ x√°c ƒë·ªãnh bao g·ªìm:</p>

<ul>
<li><strong>Initial compromise:</strong> Cu·ªôc t·∫•n c√¥ng ban ƒë·∫ßu s·∫Ω cho ph√©p k·∫ª x√¢m nh·∫≠p truy c·∫≠p ƒë∆∞·ª£c v√†o h·ªá th·ªëng m·∫°ng c·ªßa b·∫°n. ƒêa s·ªë c√°c cu·ªôc t·∫•n c√¥ng ƒë·∫ßu ti√™n kh√¥ng di·ªÖn ra m·ªôt c√°ch li√™n t·ª•c v√† m·ª©c ƒë·ªô truy c·∫≠p m√† k·∫ª t·∫•n c√¥ng c√≥ ƒë∆∞·ª£c n√≥i chung l√† kh√° mong manh. N·∫øu nh∆∞ Incident Response Team c√≥ th·ªÉ lo·∫°i ngƒÉn ch·∫∑n ƒë∆∞·ª£c k·∫ª t·∫•n c√¥ng tr∆∞·ªõc khi thi·∫øt l·∫≠p ƒë∆∞·ª£c m·ªôt k·∫øt n·ªëi v·ªõi h·ªá th·ªëng m·∫°ng c·ªßa t·ªï ch·ª©c th√¨ kh·∫£ nƒÉng s·ªëng s√≥t c·ªßa k·∫ª t·∫•n c√¥ng d∆∞·ªùng nh∆∞ b·∫±ng Zero. Tuy nhi√™n ƒëi·ªÅu n√†y r·∫•t kh√≥ ƒë·ªÉ th·ª±c hi·ªán nh·∫•t l√† khi c√°c cu·ªôc t·∫•n c√¥ng spear phishing r·∫•t kh√≥ ph√°t hi·ªán, ngƒÉn ch·∫∑n. <strong><em>(Th·∫≠t ra t√¥i c≈©ng nh∆∞ b·∫°n, d·ªãch kh√¥ng ƒë·ªçc l·∫°i kh√¥ng hi·ªÉu ƒëo·∫°n n√†y mu·ªën n√≥i c√°i g√¨ üòï)</em></strong></li>
<li><strong>Establish foothold/maintain presence:</strong> ƒë√¢y l√† c√°ch m√† k·∫ª t·∫•n c√¥ng duy tr√¨ s·ª± hi·ªán di·ªán c·ªßa m√¨nh trong h·ªá th·ªëng c·ªßa t·ªï ch·ª©c b·ªã t·∫•n c√¥ng cho d√π h·ªá th·ªëng c√≥ b·ªã kh·ªüi ƒë·ªông l·∫°i ƒëi chƒÉng n·ªØa. K·∫ª t·∫•n c√¥ng kh√¥ng c·∫ßn ph·∫£i t·∫•n c√¥ng l·∫°i h·ªá th·ªëng m·ªôt l·∫ßn n·ªØa. Vi·ªác lo·∫°i b·ªè c√°ch th·ª©c k·∫ª t·∫•n c√¥ng duy tr√¨nh s·ª± hi·ªán di·ªán c·ªßa h·ªç trong h·ªá th·ªëng m·∫°ng s·∫Ω b·∫Øt bu·ªôc k·∫ª t·∫•n c√¥ng ph·∫£i th·ª±c hi·ªán t·∫•n c√¥ng l·∫°i h·ªá th·ªëng ƒë·ªÉ thi·∫øt l·∫≠p m·ªôt ph∆∞∆°ng ph√°p duy tr√¨ kh√°c. V√≠ d·ª• nh∆∞ th·ª±c hi·ªán m·ªôt campaign spear phishing m·ªõi, exploit l·∫°i h·ªá th·ªëng c√≥ l·ªó h·ªïng&hellip;</li>
<li><strong>Lateral movement:</strong> ƒë√¢y l√† c√°ch m√† k·∫ª t·∫•n c√¥ng di chuy·ªÉn gi·ªØa c√°c h·ªá th·ªëng. N√≥ l√† c√°c k·ªπ thu·∫≠t ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ chi·∫øm quy·ªÅn ƒëi·ªÅu khi·ªÉn m·ªôt h·ªá th·ªëng kh√°c khi ƒë√£ k·∫øt n·ªëi ƒë∆∞·ª£c v√†o h·ªá th·ªëng m·∫°ng c·ªßa t·ªï ch·ª©c.</li>
<li><strong>Data collection:</strong> ƒë·ªÉ th·ª±c hi·ªán vi·ªác thu th·∫≠p d·ªØ li·ªáu, k·∫ª t·∫•n c√¥ng s·∫Ω ph·∫£i ƒë·ªÉ l√†m m·ªôt l∆∞·ª£ng l·ªõn d·∫•u v·∫øt trong qu√° tr√¨nh t√¨m ki·∫øm v√† x√°c ƒë·ªãnh c√°c d·ªØ li·ªáu c·∫ßn thu th·∫≠p n·∫±m ·ªü ƒë√¢u. Vi·ªác x√°c ƒë·ªãnh ƒë∆∞·ª£c c√°c gi·ªØ li·ªáu c√≥ gi√° tr·ªã l√† m·ªôt vi·ªác kh√≥ ƒë·ªëi v·ªõi k·∫ª t·∫•n c√¥ng v√† ƒë√¥i khi l√† v·ªõi ch√≠nh Incident Response Team ( üòÜ almost ).</li>
<li><strong>Data exfiltration:</strong> M·ªôt khi k·∫ª t√°n c√¥ng ƒë√£ t√¨m ƒë∆∞·ª£c c√°c d·ªØ li·ªáu c·∫ßn thi·∫øt, vi·ªác ti·∫øp theo h·ªç nghƒ© ƒë√™n l√† l√†m c√°ch n√†o ƒë·ªÉ ƒë∆∞a c√°c d·ªØ li·ªáu ƒë·∫•y ra ngo√†i. Vi·ªác leak d·ªØ li·ªáu ra ngo√†i th∆∞·ªùng l√† d·ªÖ n√≥i h∆°n l√† l√†m b·ªüi v√¨ chuy·ªÉn m·ªôt l∆∞·ª£ng l·ªõn d·ªØ li·ªáu ra ngo√†i r·∫•t d·ªÖ b·ªã ph√°t hi·ªán b·ªüi SOC Team ho·∫∑c c√°c automation trigger tr√™n SIEM ph√°t hi·ªán l∆∞u l∆∞·ª£ng d·ªØ li·ªáu l·ªõn b·∫•t th∆∞·ªùng. Th·∫≠t ra ƒë·∫•y l√† s√°ch n√≥i, c√≤n t√¥i th·∫•y trong th·ª±c t·∫ø vi·ªác SOC team v√† SIEM ph√°t hi·ªán ƒë∆∞·ª£c <strong>data exfiltration</strong> l√† r·∫•t kh√≥ khi m√† m√¥i tr∆∞·ªùng, h·∫° t·∫ßng CNTT kh√¥ng chu·∫©n h√≥a. Vi·ªác x√°c ƒë·ªãnh ƒë∆∞·ª£c l∆∞u l∆∞·ª£ng d·ªØ li·ªáu b·∫•t th∆∞·ªùng c·∫ßn ph·∫£i x√¢y d·ª±ng baseline. K·ªÉ c·∫£ vi·ªác x√°c ƒë·ªãnh ƒë∆∞·ª£c l∆∞u l∆∞·ª£ng gi·ªØ li·ªáu b·∫•t th∆∞·ªùng th√¨ c≈©ng m·∫•t r·∫•t nhi·ªÅu th·ªùi gian ƒë·ªÉ x√°c ƒë·ªãnh xem l∆∞u l∆∞·ª£ng ƒë·∫•y b·∫Øt ngu·ªìn t·ª´ ƒë√¢u ‚ùì n√≥ l√† b√¨nh th∆∞·ªùng ‚ùì hay b·∫•t th∆∞·ªùng ‚ùì gi·ªØ li·ªáu trong lu·ªìng gi·ªØ li·ªáu b·∫•t th∆∞·ªùng ƒë·∫•y l√† g√¨ ? C√≥ th·ªÉ tr·∫£ l·ªùi xong c√°c c√¢u h·ªèi tr√™n th√¨ data ƒë√£ ƒë∆∞·ª£c leak xong ra ngo√†i. B·∫°n c√≥ gi√°m drop connect n√†y khi ch∆∞a tr·∫£ l·ªùi ƒë∆∞·ª£c h·∫øt c√°c c√¢u h·ªèi tr√™n kh√¥ng  ‚ùì</li>
</ul>

<p>Anyway, ƒë√¢y l√† b∆∞·ªõc c·∫ßn ph·∫£i t√¨m ra v√† ngƒÉn ch·∫∑n b·∫±ng m·ªçi c√°ch c√≥ th·ªÉ. ƒê·ªÉ k·∫ª t·∫•n c√¥ng th·ª±c hi·ªán <strong>data exfiltration</strong> m√† kh√¥ng b·ªã ngƒÉn ch·∫∑n v√† ph√°t hi·ªán th√¨ &hellip;..  üò∂</p>

        
    </div>
</article>
<section class="comment">
    <p class="local-info">
        Comment is disabled to avoid unwanted discussions from 'localhost:1313' on your Disqus
        account...
    </p>
    <div id="disqus_thread"></div>
</section>
<script type="text/javascript">

    (function () {
        if (window.location.hostname == "localhost") {
            return
        }
        document.querySelector('.local-info').classList.add('hide')

        let dsq = document.createElement('script')
        dsq.type = 'text/javascript'
        dsq.async = true
        let disqus_shortname = 'vnstrawhat'
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq)
    })()
</script>

        </main>
    </div>
    <footer class="footer clearfix">
    <ul class="control social clearfix">
        <li><a class="author btn" href="#">TrungKFC</a></li>
        
        
        <li>
            <a class="icon-link btn" href="%20"><i class="icon email"></i></a>
        </li>
        
        
        
        <li>
            <a class="icon-link btn" href="%20"><i class="icon facebook"></i></a>
        </li>
        
        
        
        <li>
            <a class="icon-link btn" href="%20"><i class="icon github"></i></a>
        </li>
        
        
        
        <li>
            <a class="icon-link btn" href="%20"><i class="icon twitter"></i></a>
        </li>
        
        
        <li>
            <a class="icon-link btn" href="https://vnstrawhat.github.io/index.xml" type="application/rss+xml" title="rss">
            <i class="rss icon"></i></a>
        </li>
    </ul>
    <ul class="control status clearfix">
        <li><a href="#" class="btn">Posts:
        12</a>
    </li>
    <li><a href="#" class="btn">Pages:
    0</a></li>
</ul>
</footer>
<div class="dialog">
<div class="wrapper">
    <div class="clearfix"><button class="btn close-dialog">X</button></div>
    <header>
        <h1 class="title">Theme Name</h1>
    </header>
    <main>
        <div class="clearfix">
            <label for="theme-name">
                <p>Only English Character, space, hyphen are allowed!</p>
            </label>
            <input type="text" name="theme-name" id="theme-name">
        </div>
        <div class="clearfix">
            <button class="btn export">Export</button>
        </div>
    </main>
<footer></footer>
</div>
</div>
    <script src="https://vnstrawhat.github.io/js/main.js"></script>



<script src="https://vnstrawhat.github.io/js/highlight.pack.js"></script>

<script>
hljs.initHighlightingOnLoad();
hljs.getLanguage('console').k += ' use apt-get wmic python perl ruby lua git powershell.exe powershell msf msfvenom nc certutil.exe certutil regsvr32 rundll32.exe rundll32 mshta.exe mshta exploit cat telnet rm msiexec certutil.exe certutil php bash'; 
</script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'your ga id', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
